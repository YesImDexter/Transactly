<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>eKYC Form</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
      body {
          font-family: 'Inter', sans-serif;
      }
      /* Custom styles for scrollable text within the modal */
      .scrollable-text {
          max-height: 200px; /* Adjust as needed */
          overflow-y: auto;
          padding-right: 10px; /* Space for scrollbar */
      }
      /* Hide scrollbar for the scrollable-text */
      .scrollable-text::-webkit-scrollbar {
          width: 8px;
      }
      .scrollable-text::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 10px;
      }
      .scrollable-text::-webkit-scrollbar-thumb {
          background: #888;
          border-radius: 10px;
      }
      .scrollable-text::-webkit-scrollbar-thumb:hover {
          background: #555;
      }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
  <div class="w-full max-w-4xl bg-white rounded-3xl shadow-xl overflow-hidden flex flex-col md:flex-row">

    <!-- Left panel -->
    <div class="md:w-1/2 p-8 bg-gradient-to-br from-indigo-600 to-blue-500 text-white flex flex-col justify-between">
      <div>
        <h2 class="text-3xl font-bold mb-4">eKYC Verification</h2>
        <p class="text-white/80">Please complete this form to link your new eWallet securely.</p>
      </div>
    </div>

    <!-- Right panel (form) -->
    <form id="ekycForm" class="md:w-1/2 p-8 space-y-6 overflow-y-auto">
      <h3 class="text-2xl font-bold text-gray-800">eKYC Details</h3>

      <!-- Personal Info -->
      <div class="space-y-4">
        <input type="text" placeholder="Full Name (as per ID)" class="w-full px-4 py-2 border rounded-xl" required />
        <select class="w-full px-4 py-2 border rounded-xl" required>
          <option value="">Select Nationality</option>
          <option>Malaysia</option>
          <option>Singapore</option>
          <!-- Add more -->
        </select>
        <select class="w-full px-4 py-2 border rounded-xl" required>
          <option value="">Country of Residence</option>
          <option>Malaysia</option>
          <option>Singapore</option>
        </select>
        <input type="date" class="w-full px-4 py-2 border rounded-xl" required />
        <select class="w-full px-4 py-2 border rounded-xl">
          <option value="">Gender (optional)</option>
          <option>Male</option>
          <option>Female</option>
          <option>Prefer not to say</option>
        </select>
      </div>

      <!-- ID Verification -->
      <div class="space-y-4">
        <select class="w-full px-4 py-2 border rounded-xl" required>
          <option value="">Select ID Type</option>
          <option>NRIC</option>
          <option>Passport</option>
        </select>
        <input type="text" placeholder="ID Number" class="w-full px-4 py-2 border rounded-xl" required />
      </div>

      <!-- Contact -->
      <div class="space-y-4">
        <input type="tel" placeholder="Mobile Number" class="w-full px-4 py-2 border rounded-xl" required />
        <input type="email" placeholder="Email Address" class="w-full px-4 py-2 border rounded-xl" />
      </div>

      <!-- eWallet Info -->
      <div class="space-y-4">
        <select class="w-full px-4 py-2 border rounded-xl" required>
          <option value="">Select eWallet</option>
          <option>Touch 'n Go</option>
          <option>Boost</option>
          <option>GrabPay</option>
        </select>
        <input type="text" placeholder="eWallet Account ID" class="w-full px-4 py-2 border rounded-xl" required />
        <input type="text" placeholder="Account Holder Name" class="w-full px-4 py-2 border rounded-xl" required />
      </div>

      <!-- Submit button -->
      <button type="submit" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-semibold hover:bg-indigo-700 transition-colors duration-200">Submit</button>
    </form>
  </div>

  <!-- Consent Modal -->
  <div id="consentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full m-4 relative">
      <button id="closeConsentModalBtn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-300 rounded-full p-1 transition-colors duration-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      <h3 class="text-2xl font-bold text-gray-800 mb-4">Consent & Privacy Policy</h3>
      <div class="scrollable-text text-gray-700 text-sm leading-relaxed mb-6">
        <p>In order to proceed with identity verification, we require your consent to collect, use, and process your personal data in accordance with our privacy practices.</p>
        <p class="mt-3">The data collected may include your full name, identification number (MyKad or passport), date of birth, residential address, a photograph of your identification document, and a live facial image (selfie).</p>
        <p class="mt-3">This information will be used solely for the purpose of verifying your identity, ensuring security, and fulfilling our legal and regulatory obligations, including compliance with Know Your Customer (KYC) and Anti-Money Laundering (AML) requirements.</p>
        <p class="mt-3">All personal data submitted will be encrypted and stored securely. Access to your information is restricted to authorized personnel and systems, and will not be used for marketing purposes without your explicit permission.</p>
        <p class="mt-3">Your data may be disclosed to relevant government authorities or trusted third-party service providers only when legally required or when essential for completing the verification process.</p>
        <p class="mt-3">You have the right to access and correct your personal data, request the deletion of your data (subject to legal limitations), and withdraw your consent at any time. Please note that withdrawing consent may prevent you from continuing to use certain features of this application.</p>
        <p class="mt-3 font-semibold">By selecting the checkbox below and proceeding, you acknowledge that you have read, understood, and agree to the terms of this Consent & Privacy Policy.</p>
      </div>
      <label class="flex items-center text-gray-700 mb-6">
        <input type="checkbox" id="consentCheckbox" class="mr-2 h-4 w-4 text-blue-600 rounded focus:ring-blue-500" required>
        I have read and agree to the terms
      </label>
      <button id="confirmConsentBtn" class="w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors duration-200">Confirm</button>
    </div>
  </div>

  <script>
    const ekycForm = document.getElementById('ekycForm');
    const consentModal = document.getElementById('consentModal');
    const consentCheckbox = document.getElementById('consentCheckbox');
    const confirmConsentBtn = document.getElementById('confirmConsentBtn');
    const closeConsentModalBtn = document.getElementById('closeConsentModalBtn');

    // Function to display a custom message box instead of alert
    function showMessageBox(title, message, type = 'info') {
        console.log(`[MessageBox] Showing: ${title} - ${message}`); // Debugging log
        const messageBox = document.createElement('div');
        messageBox.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        let titleColor = 'text-blue-600';
        if (type === 'error') {
            titleColor = 'text-red-600';
        } else if (type === 'warning') {
            titleColor = 'text-yellow-600';
        }

        messageBox.innerHTML = `
            <div class="bg-white p-6 rounded-lg shadow-lg text-center max-w-sm mx-auto">
                <p class="text-lg ${titleColor} mb-4 font-semibold">${title}</p>
                <p class="text-gray-700">${message}</p>
                <button onclick="this.parentNode.parentNode.remove()" class="mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors duration-200">Close</button>
            </div>
        `;
        document.body.appendChild(messageBox);
    }

    // Handle eKYC form submission
    ekycForm.addEventListener('submit', (event) => {
      event.preventDefault(); // Prevent default form submission
      console.log("[Form Submission] Form submitted."); // Debugging log

      // Check if all required form fields are filled
      const requiredInputs = ekycForm.querySelectorAll('[required]');
      let allFieldsFilled = true;
      for (let i = 0; i < requiredInputs.length; i++) {
        if (requiredInputs[i].type !== 'file' && !requiredInputs[i].value) {
          allFieldsFilled = false;
          console.log(`[Form Validation] Field '${requiredInputs[i].placeholder || requiredInputs[i].name}' is empty.`); // Debugging log
          break;
        }
      }

      if (allFieldsFilled) {
        console.log("[Form Validation] All required fields filled. Showing consent modal."); // Debugging log
        consentModal.classList.remove('hidden'); // Show the consent modal
      } else {
        console.log("[Form Validation] Required fields missing. Showing warning message."); // Debugging log
        showMessageBox('Missing Information', 'Please fill in all required fields before proceeding.', 'warning');
      }
    });

    // Handle consent modal confirm button click
    confirmConsentBtn.addEventListener('click', () => {
      console.log("[Consent Confirm Button] Clicked."); // Debugging log
      if (consentCheckbox.checked) {
        console.log("[Consent Confirm Button] Checkbox is checked. Closing consent modal."); // Debugging log
        consentModal.classList.add('hidden'); // Hide the consent modal
        // No redirection here. The page will remain on the eKYC form.
      } else {
        console.log("[Consent Confirm Button] Checkbox is NOT checked. Showing consent required message."); // Debugging log
        showMessageBox('Consent Required', 'You must agree to the terms to proceed with verification.', 'warning');
      }
    });

    // Handle close button click for the consent modal
    closeConsentModalBtn.addEventListener('click', () => {
      console.log("[Close Consent Modal Button] Clicked."); // Debugging log
      consentModal.classList.add('hidden'); // Hide the consent modal
      consentCheckbox.checked = false; // Uncheck the consent box when closing
    });
  </script>
</body>
</html>
